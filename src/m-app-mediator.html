<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="m-mediator-behavior.html">
<link rel="import" href="m-chart-mediator.html">
<link rel="import" href="m-panel.html">
<link rel="import" href="m-timer.html">

<dom-module id="m-app-mediator">
  <template>
    <style>
      m-panel {
        position: relative;
        display: block;
        width: 80vw;
        max-width: 500px;
        margin: 5vh auto 0;
      }
    </style>

    <m-timer on-tick="onTimerTick"></m-timer>
    <m-panel time="[[time]]" date="[[date]]" on-log-time="onLogTime"></m-panel>
    <m-chart-mediator state="[[state]]"></m-chart-mediator>
  </template>

  <script>
    Polymer({

      is: 'm-app-mediator',

      properties: {
        state: Object,
        time: String,
        date: String,
      },

      observers: [
        'onDateStringChanged(state.datestring)',
        'onTimeStringChanged(state.timestring)',
      ],

      onTimerTick: function(e) {
        var info = e.detail;
        this.fire('m-time-change', info.ts);
      },

      onLogTime: function(e) {
        this.fire('m-log-time');
      },

      onDateStringChanged: function(datestring) {
        this.date = datestring;
      },

      onTimeStringChanged: function(timestring) {
        this.time = timestring;
      },

    });
  </script>
</dom-module>
